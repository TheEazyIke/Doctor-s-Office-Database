spool '3304_Project2Solution_ilw.txt'
set echo on

--DROP all tables in the opposite order they're created
DROP TABLE APPTDETAIL_ilw ;
DROP TABLE APPOINTMENT_ilw ;
DROP TABLE TREATMENT_ilw ;
DROP TABLE PATIENT_ilw ;
DROP TABLE BLOCKCODE_ilw ;
DROP TABLE BILLINGTYPE_ilw ;
DROP TABLE INSURANCECO_ilw ;
DROP TABLE PROVIDER_ilw ;
DROP TABLE APPTSTATUS_ilw ;
DROP TABLE PMTSTATUS_ilw ;

--Part IA
-- CREATE all the tables
CREATE TABLE PMTSTATUS_ilw (
PmtStatus	CHAR(2),
PmtDesc		CHAR(15) NOT NULL,
PRIMARY KEY (PmtStatus)
) ;

CREATE TABLE APPTSTATUS_ilw (
ApptStatusCode	CHAR(2),
ApptStatusDesc	VARCHAR(15) NOT NULL,
PRIMARY KEY (ApptStatusCode)
) ;

CREATE TABLE PROVIDER_ilw (
ProvID		NUMBER(2),
ProviderFName	VARCHAR(15) NOT NULL,
ProviderLName	VARCHAR(15) NOT NULL,
PRIMARY KEY (ProvID)
) ;

CREATE TABLE INSURANCECO_ilw (
InsCoID		Number(3) NULL,
InsCoName	VARCHAR(20),
PRIMARY KEY (InsCoID)
) ;

CREATE TABLE BILLINGTYPE_ilw (
BillingType	CHAR(2),
BillingTypeDesc	CHAR(15) NOT NULL,
PRIMARY KEY (BillingType)
) ; 

CREATE TABLE BLOCKCODE_ilw (
BlockCode	CHAR(2),
BlockDesc	CHAR(10) NOT NULL,
BlockMinutes	NUMBER(3),
PRIMARY KEY (BlockCode)
);

CREATE TABLE PATIENT_ilw (
PatientID	Number(4),
PatientFName	VARCHAR(15) NOT NULL,
PatientLName	VARCHAR(15) NOT NULL,
PatientPhone	CHAR(10),
PRIMARY KEY (PatientID)
) ;

CREATE TABLE TREATMENT_ilw (
TreatmentCode	CHAR(4),
TreatmentDesc	VARCHAR(25) NOT NULL,
TreatmentRate	NUMBER(6,2) NOT NULL,
BlockCode	CHAR(2),
PRIMARY KEY (TreatmentCode),
FOREIGN KEY (BlockCode) REFERENCES BLOCKCODE_ilw
) ;

CREATE TABLE APPOINTMENT_ilw (
ApptID		NUMBER(4),
ApptDateTime	DATE NOT NULL,
PatientID	NUMBER (4) NOT NULL,
BillingType	CHAR(2) NOT NULL,
InsCoID		NUMBER(3),
ProvID		NUMBER(2) NOT NULL,
ApptStatusCode	CHAR(2) NOT NULL,
PmtStatus	CHAR(2) NOT NULL,
PRIMARY KEY (ApptID),
FOREIGN KEY (PmtStatus) REFERENCES PMTSTATUS_ilw,
FOREIGN KEY (ApptStatusCode) REFERENCES APPTSTATUS_ilw,
FOREIGN KEY (ProvID) REFERENCES PROVIDER_ilw,
FOREIGN KEY (InsCoID) REFERENCES INSURANCECO_ilw,
FOREIGN KEY (BillingType) REFERENCES BILLINGTYPE_ilw,
FOREIGN KEY (PatientID) REFERENCES PATIENT_ilw
);

CREATE TABLE APPTDETAIL_ilw (
ApptID			NUMBER(4),
TreatmentCode	CHAR(4),
PRIMARY KEY (ApptID, TreatmentCode),
FOREIGN KEY (ApptID) REFERENCES APPOINTMENT_ilw, 
FOREIGN KEY (TreatmentCode) REFERENCES TREATMENT_ilw
) ;


-- Part 1B
DESCRIBE PMTSTATUS_ilw
DESCRIBE APPTSTATUS_ilw
DESCRIBE PROVIDER_ilw
DESCRIBE INSURANCECO_ilw
DESCRIBE BILLINGTYPE_ilw
DESCRIBE BLOCKCODE_ilw
DESCRIBE PATIENT_ilw
DESCRIBE TREATMENT_ilw
DESCRIBE APPOINTMENT_ilw
DESCRIBE APPTDETAIL_ilw

-- Part 2A
-- Insert rows into PMTSTATUS table
INSERT INTO PMTSTATUS_ilw
VALUES ('PD', 'Paid in Full') ;
INSERT INTO PMTSTATUS_ilw
VALUES ('PP', 'Partial Pmt');
INSERT INTO PMTSTATUS_ilw
VALUES ('NP', 'Not Paid');

-- Insert rows into APPTSTATUS table
INSERT INTO APPTSTATUS_ilw
VALUES ('CM', 'Complete') ;
INSERT INTO APPTSTATUS_ilw
VALUES ('CN', 'Confirmed');
INSERT INTO APPTSTATUS_ilw
VALUES ('NC', 'Not Confirmed');

-- Insert rows into PROVIDER table
INSERT INTO PROVIDER_ilw
VALUES (1, 'Kay', 'Jones');
INSERT INTO PROVIDER_ilw
VALUES (2, 'Michael', 'Smith') ;
INSERT INTO PROVIDER_ilw
VALUES (3, 'Ray', 'Schultz');
INSERT INTO PROVIDER_ilw
VALUES (5, 'Janice', 'May');


-- Insert rows into INSURANCE table
INSERT INTO INSURANCECO_ilw
VALUES (323, 'Humana');
INSERT INTO INSURANCECO_ilw
VALUES (129, 'Blue Cross');
INSERT INTO INSURANCECO_ilw
VALUES (135, 'TriCare');
INSERT INTO INSURANCECO_ilw
VALUES (210, 'State Farm');


--Insert rows into BILLINGTYPE table
INSERT INTO BILLINGTYPE_ilw
VALUES ('I', 'Insurance');
INSERT INTO BILLINGTYPE_ilw
VALUES ('SP', 'Self-Pay');
INSERT INTO BILLINGTYPE_ilw
VALUES ('WC', 'Worker''s Comp');

--Insert rows into BLOCKCODE table
INSERT INTO BLOCKCODE_ilw
VALUES ('L1', 'Level 1', 15);
INSERT INTO BLOCKCODE_ilw
VALUES ('L2', 'Level 2', 20);
INSERT INTO BLOCKCODE_ilw
VALUES ('L3', 'Level 3', 30);
INSERT INTO BLOCKCODE_ilw
VALUES ('L4', 'Level 4', 60);

-- Insert rows into PATIENT table
INSERT INTO PATIENT_ilw
VALUES (101, 'Wesley', 'Tanner', '8175551193');
INSERT INTO PATIENT_ilw
VALUES (100, 'Brenda', 'Rhodes', '2145559191');
INSERT INTO PATIENT_ilw
VALUES (15, 'Jeff', 'Miner', '4695552301');
INSERT INTO PATIENT_ilw
VALUES (77, 'Kim', 'Jackson', '8175554911');
INSERT INTO PATIENT_ilw
VALUES (119, 'Mary', 'Vaughn', '8175552334');
INSERT INTO PATIENT_ilw
VALUES (97, 'Chris', 'Mancha', '4695553440');
INSERT INTO PATIENT_ilw
VALUES (28, 'Renee', 'Walker', '2145559285');
INSERT INTO PATIENT_ilw
VALUES (105, 'Johnny', 'Redmond', '2145551084');
INSERT INTO PATIENT_ilw
VALUES (84,'James', 'Clayton', '2145559285');
INSERT INTO PATIENT_ilw
VALUES (23, 'Shelby', 'Davis', '8175551198');

--Insert rows for TREATMENT table
INSERT INTO TREATMENT_ilw
VALUES ('NP', 'New Patient', 45, 'L1');
INSERT INTO TREATMENT_ilw
VALUES ('GBP', 'General Back Pain', 60, 'L2');
INSERT INTO TREATMENT_ilw
VALUES ('XR', 'X-Ray', 250, 'L2');
INSERT INTO TREATMENT_ilw
VALUES ('PSF', 'Post-Surgery Follow Up', 30,'L1');
INSERT INTO TREATMENT_ilw
VALUES ('SR', 'Suture Removal', 50, 'L2');
INSERT INTO TREATMENT_ilw
VALUES ('PT30', 'Physical Therapy 30', 60, 'L3');
INSERT INTO TREATMENT_ilw
VALUES ('BI', 'Back Injury', 60, 'L2');
INSERT INTO TREATMENT_ilw
VALUES ('PT60', 'Physical Therapy 60', 110, 'L4');
INSERT INTO TREATMENT_ilw
VALUES ('HP', 'Hip Pain', 60, 'L2');


-- Insert rows for APPOINTMENT table
INSERT INTO APPOINTMENT_ilw
VALUES (101, TO_DATE('02/19/2024 09:00AM', 'MM/DD/YYYY HH:MIAM'), 101, 'I', 323, 2, 'CM', 'PD');
INSERT INTO APPOINTMENT_ilw
VALUES (102, TO_DATE('02/19/2024 09:00AM', 'MM/DD/YYYY HH:MIAM'), 100, 'I', 129, 5, 'CM', 'PP');
INSERT INTO APPOINTMENT_ilw
VALUES (103, TO_DATE('02/19/2024 10:00AM', 'MM/DD/YYYY HH:MIAM'), 15, 'SP', NULL, 2, 'CM', 'PD');
INSERT INTO APPOINTMENT_ilw
VALUES (104, TO_DATE('02/19/2024 10:30AM', 'MM/DD/YYYY HH:MIAM'), 77, 'WC', 210, 1, 'CM', 'PD');
INSERT INTO APPOINTMENT_ilw
VALUES (105, TO_DATE('02/19/2024 10:30AM', 'MM/DD/YYYY HH:MIAM'), 119, 'I', 129, 2, 'CM', 'PP');
INSERT INTO APPOINTMENT_ilw
VALUES (106, TO_DATE('02/19/2024 10:30AM', 'MM/DD/YYYY HH:MIAM'), 97, 'SP', NULL, 3, 'CM', 'PP');
INSERT INTO APPOINTMENT_ilw
VALUES (107, TO_DATE('02/19/2024 11:30AM', 'MM/DD/YYYY HH:MIAM'), 28, 'I', 129, 3, 'CN', 'PP');
INSERT INTO APPOINTMENT_ilw
VALUES (108, TO_DATE('02/19/2024 11:30AM', 'MM/DD/YYYY HH:MIAM'), 105, 'I', 323, 2, 'CN', 'NP');
INSERT INTO APPOINTMENT_ilw
VALUES (109, TO_DATE('02/19/2024 02:00PM', 'MM/DD/YYYY HH:MIPM'), 84, 'I', 135, 5, 'CN', 'NP');
INSERT INTO APPOINTMENT_ilw
VALUES (110, TO_DATE('02/20/2024 08:30AM', 'MM/DD/YYYY HH:MIAM'), 84, 'I', 135, 3, 'NC', 'NP');
INSERT INTO APPOINTMENT_ilw
VALUES (111, TO_DATE('02/20/2024 08:30AM', 'MM/DD/YYYY HH:MIAM'), 23, 'WC', 323, 5, 'CN', 'NP');

-- Insert rows for APPTDETAIL table
INSERT INTO APPTDETAIL_ilw
VALUES (101, 'NP');
INSERT INTO APPTDETAIL_ilw
VALUES (101, 'GBP');
INSERT INTO APPTDETAIL_ilw
VALUES (101, 'XR');
INSERT INTO APPTDETAIL_ilw
VALUES (102, 'PSF');
INSERT INTO APPTDETAIL_ilw
VALUES (102, 'SR');
INSERT INTO APPTDETAIL_ilw
VALUES (103, 'PSF');
INSERT INTO APPTDETAIL_ilw
VALUES (103, 'SR');
INSERT INTO APPTDETAIL_ilw
VALUES (104, 'PT30');
INSERT INTO APPTDETAIL_ilw
VALUES (105, 'NP');
INSERT INTO APPTDETAIL_ilw
VALUES (105, 'BI');
INSERT INTO APPTDETAIL_ilw
VALUES (106, 'PT60');
INSERT INTO APPTDETAIL_ilw
VALUES (107, 'PT30');
INSERT INTO APPTDETAIL_ilw
VALUES (108, 'GBP');
INSERT INTO APPTDETAIL_ilw
VALUES (109, 'PSF');
INSERT INTO APPTDETAIL_ilw
VALUES (109, 'SR');
INSERT INTO APPTDETAIL_ilw
VALUES (110, 'PT60');
INSERT INTO APPTDETAIL_ilw
VALUES (111, 'NP');
INSERT INTO APPTDETAIL_ilw
VALUES (111, 'HP');
INSERT INTO APPTDETAIL_ilw
VALUES (111, 'XR');

-- Save all rows to disk
COMMIT;

-- Part IIB
SELECT * FROM PMTSTATUS_ilw ;
SELECT * FROM APPTSTATUS_ilw ;
SELECT * FROM PROVIDER_ilw ;
SELECT * FROM INSURANCECO_ilw ;
SELECT * FROM BILLINGTYPE_ilw ;
SELECT * FROM BLOCKCODE_ilw ;
SELECT * FROM PATIENT_ilw ;
SELECT * FROM TREATMENT_ilw ;
SELECT * FROM APPOINTMENT_ilw ;
SELECT * FROM APPTDETAIL_ilw ;


-- Part III
-- PATIENT Table
UPDATE PATIENT_ilw
	SET PatientPhone = '2145551234'
	WHERE PatientID = 100;

INSERT INTO PATIENT_ilw
VALUES (120, 'Amanda', 'Green', NULL);

-- TREATMENT Table
INSERT INTO TREATMENT_ilw
VALUES ('CI1', 'Cortisone Injection 1', 50, 'L1');
INSERT INTO TREATMENT_ilw
VALUES ('CI2', 'Cortizone Injection 1', 100, 'L1');

-- APPOINTMENT Table
UPDATE APPOINTMENT_ilw
	SET ApptDateTime = TO_DATE('02/21/2024 11:30AM', 'MM/DD/YYYY HH:MIAM')
	WHERE ApptID = 108;

UPDATE APPOINTMENT_ilw
	SET BillingType = 'WC'
	WHERE ApptID = 107;
INSERT INTO APPOINTMENT_ilw
VALUES(112, TO_DATE('02/21/2024 9:00AM', 'MM/DD/YYYY HH/MIAM'), 120, 'SP', NULL, 2, 'NC', 'NP');

-- APPTDETAIL Table
INSERT INTO APPTDETAIL_ilw
VALUES (112, 'NP');
INSERT INTO APPTDETAIL_ilw
VALUES (112, 'HP');
INSERT INTO APPTDETAIL_ilw
VALUES (112, 'CI2');

DELETE FROM APPTDETAIL_ilw
WHERE ApptID = 105 AND TreatmentCode = 'BI';

INSERT INTO APPTDETAIL_ilw
VALUES (105, 'GBP') ;

-- Save Changes to the data
COMMIT ;

SELECT * FROM PMTSTATUS_ilw
ORDER BY PmtStatus ;
SELECT * FROM APPTSTATUS_ilw
ORDER BY ApptStatusCode ;
SELECT * FROM PROVIDER_ilw
ORDER BY ProvID ;
SELECT * FROM INSURANCECO_ilw
ORDER BY InsCoID ;
SELECT * FROM BILLINGTYPE_ilw
ORDER BY BillingType ;
SELECT * FROM BLOCKCODE_ilw
ORDER BY BlockCode ;
SELECT * FROM PATIENT_ilw
ORDER BY PatientID ;
SELECT * FROM TREATMENT_ilw
ORDER BY TreatmentCode ;
SELECT * FROM APPOINTMENT_ilw
ORDER BY ApptID ;
SELECT * FROM APPTDETAIL_ilw 
ORDER BY ApptID, TreatmentCode ;
	
--Stop logging to the output file
set echo off

--Close and save the output file
spool off
