spool "3304_Proj2_Output.txt"


set echo on

--Isaac Lewis Woodcock
--INSY 3304-001
--Project 2


DROP TABLE APPTDETAIL_ilw ;
DROP TABLE APPOINTMENT_ilw ;
DROP TABLE TREATMENT_ilw ;
DROP TABLE BLOCKCODE_ilw ;
DROP TABLE PATIENT_ilw ;
DROP TABLE BILLINGTYPE_ilw ;
DROP TABLE INSURANCECO_ilw ;
DROP TABLE PROVIDER_ilw ;
DROP TABLE APPTSTATUS_ilw ;
DROP TABLE PMTSTATUS_ilw ;

--Part 1A

CREATE TABLE PMTSTATUS_ilw(
PmtStatus	char(2),
PmtDesc		varchar(15) NOT NULL,
PRIMARY KEY (PmtStatus)
) ;
CREATE TABLE APPTSTATUS_ilw(
ApptStatusCode		char(2),
ApptStatusDesc		varchar(15)	NOT NULL,
PRIMARY KEY (ApptStatusCode)	
) ;
CREATE TABLE PROVIDER_ilw(
ProviderID	number(2),
ProviderFName	varchar(15)	NOT NULL,
ProviderLName	varchar(15)	NOT NULL,
PRIMARY KEY (ProviderID)
) ;
CREATE TABLE INSURANCECO_ilw(
InsCoID		number(3),
InsCoName	varchar(20),
PRIMARY KEY (InsCoID)
) ;
CREATE TABLE BILLINGTYPE_ilw(
BillingType	varchar(2),
BillingTypeDesc	varchar(15)	NOT NULL,
PRIMARY KEY (BillingType)
) ;
CREATE TABLE PATIENT_ilw(
PatientID	number(4),
PatientFName	varchar(15)	NOT NULL,
PatientLName	varchar(15)	NOT NULL,
PatientPhone	char(10),
PRIMARY KEY (PatientID)
) ;
CREATE TABLE BLOCKCODE_ilw(
BlockCode	varchar(3),
BlockDesc	varchar(9)	NOT NULL,
BlockMinutes	number(3)	NOT NULL,
PRIMARY KEY (BlockCode)
) ;
CREATE TABLE TREATMENT_ilw(
TreatmentCode	varchar(5),
TreatmentDesc	varchar(25)	NOT NULL,
TreatmentRate	number(6,2)	NOT NULL,
BlockCode	varchar(3)	NOT NULL,
PRIMARY KEY (TreatmentCode),
FOREIGN KEY (BlockCode) REFERENCES BLOCKCODE_ilw
) ;
CREATE TABLE APPOINTMENT_ilw(
ApptID		number(4),
ApptDateTime	date		NOT NULL,
PatientID	number(4)	NOT NULL,	
BillingType	varchar(2)	NOT NULL,
InsCoID		number(3),
ProvID		number(2)	NOT NULL,
ApptStatusCode	char(2)		NOT NULL,
PmtStatus	char(2)		NOT NULL,
PRIMARY KEY (ApptID),
FOREIGN KEY (PatientID) REFERENCES PATIENT_ilw,
FOREIGN KEY (BillingType) REFERENCES BILLINGTYPE_ilw,
FOREIGN KEY (InsCoID) REFERENCES INSURANCECO_ilw,
FOREIGN KEY (ProvID) REFERENCES PROVIDER_ilw,
FOREIGN KEY (ApptStatusCode) REFERENCES APPTSTATUS_ilw,
FOREIGN KEY (PmtStatus) REFERENCES PMTSTATUS_ilw
) ;
CREATE TABLE APPTDETAIL_ilw(
ApptID		number(4)	NOT NULL,
TreatmentCode	varchar(5)	NOT NULL,
PRIMARY KEY (ApptID, TreatmentCode),
FOREIGN KEY (ApptID) REFERENCES APPOINTMENT_ilw,
FOREIGN KEY (TreatmentCode) REFERENCES TREATMENT_ilw
) ;

COMMIT;


--Part 1B

DESCRIBE APPTDETAIL_ilw 
DESCRIBE APPOINTMENT_ilw 
DESCRIBE TREATMENT_ilw 
DESCRIBE BLOCKCODE_ilw 
DESCRIBE PATIENT_ilw 
DESCRIBE BILLINGTYPE_ilw 
DESCRIBE INSURANCECO_ilw 
DESCRIBE PROVIDER_ilw 
DESCRIBE APPTSTATUS_ilw 
DESCRIBE PMTSTATUS_ilw 


--2A

--PATIENT
--PatientID, PatientFName, PatientLName, PatientPhone

INSERT INTO PATIENT_ilw
VALUES (101, 'Wesley', 'Tanner', '8175551193');

INSERT INTO PATIENT_ilw
VALUES (100, 'Brenda', 'Rhodes', '2145559191');

INSERT INTO PATIENT_ilw
VALUES (15, 'Jeff', 'Miner', '4695552301');

INSERT INTO PATIENT_ilw
VALUES (77, 'Kim', 'Jackson', '8175554911');

INSERT INTO PATIENT_ilw
VALUES (119, 'Mary', 'Vaughn', '8175552334');

INSERT INTO PATIENT_ilw
VALUES (97, 'Chris', 'Mancha', '4695553440');

INSERT INTO PATIENT_ilw
VALUES (28, 'Renee', 'Walker', '2145559285');

INSERT INTO PATIENT_ilw
VALUES (105, 'Johnny', 'Redmond', '2145551084');

INSERT INTO PATIENT_ilw
VALUES (84, 'James', 'Clayton', '2145559285');

INSERT INTO PATIENT_ilw
VALUES (23, 'Shelby', 'Davis', '8175551198');


--BILLINGTYPE
--BillingType, BillingTypeDesc

INSERT INTO BillingType_ilw
VALUES ('I', 'Insurance');

INSERT INTO BillingType_ilw
VALUES ('SP', 'Self-Pay');

INSERT INTO BillingType_ilw
VALUES ('WC', 'Worker''s Comp');


--INSURANCECO
--InsCoID, InsCoName

INSERT INTO INSURANCECO_ilw
VALUES (323, 'Humana');

INSERT INTO INSURANCECO_ilw
VALUES (129, 'Blue Cross');

INSERT INTO INSURANCECO_ilw
VALUES (210, 'State Farm');

INSERT INTO INSURANCECO_ilw
VALUES (135, 'TriCare');


--PROVIDER
--ProvID, ProvFName, ProvLName

INSERT INTO PROVIDER_ilw
VALUES (2, 'Michael', 'Smith');

INSERT INTO PROVIDER_ilw
VALUES (5, 'Janice', 'May');

INSERT INTO PROVIDER_ilw
VALUES (1, 'Kay', 'Jones');

INSERT INTO PROVIDER_ilw
VALUES (3, 'Ray', 'Schultz');


--APPTSTATUS
--ApptStatusCode, ApptStatusDesc

INSERT INTO APPTSTATUS_ilw
VALUES ('CM', 'Complete');

INSERT INTO APPTSTATUS_ilw
VALUES ('CN', 'Confirmed');

INSERT INTO APPTSTATUS_ilw
VALUES ('NC', 'Not Confirmed');


--PMTSTATUS
--PmtStatus, PmtDesc

INSERT INTO PMTSTATUS_ilw
VALUES ('PD', 'Paid in Full');

INSERT INTO PMTSTATUS_ilw
VALUES ('PP', 'Partial Payment');

INSERT INTO PMTSTATUS_ilw
VALUES ('NP', 'Not Paid');


--BLOCKCODE
--BlockCode, BlockDesc, BlockMinutes

INSERT INTO BLOCKCODE_ilw
VALUES ('L1', 'Level 1', 15);

INSERT INTO BLOCKCODE_ilw
VALUES ('L2', 'Level 2', 20);

INSERT INTO BLOCKCODE_ilw
VALUES ('L3', 'Level 3', 30);

INSERT INTO BLOCKCODE_ilw
VALUES ('L4', 'Level 4', 60);


--TREATMENT
--TreatmentCode, TreatmentDesc, TreatmentRate, BlockCode

INSERT INTO TREATMENT_ilw
VALUES ('NP', 'New Patient', 45, 'L1');

INSERT INTO TREATMENT_ilw
VALUES ('GBP', 'General Back Pain', 60, 'L2');

INSERT INTO TREATMENT_ilw
VALUES ('XR', 'X-Ray', 250, 'L2');

INSERT INTO TREATMENT_ilw
VALUES ('PSF', 'Post-Surgery Follow Up', 30, 'L1');

INSERT INTO TREATMENT_ilw
VALUES ('SR', 'Suture Removal', 50, 'L2');

INSERT INTO TREATMENT_ilw
VALUES ('PT30', 'Physical Therapy 30', 60, 'L3');

INSERT INTO TREATMENT_ilw
VALUES ('BI', 'Back Injury', 60, 'L2');

INSERT INTO TREATMENT_ilw
VALUES ('PT60', 'Physical Therapy 60', 110, 'L4');

INSERT INTO TREATMENT_ilw
VALUES ('HP', 'Hip Pain', 60, 'L2');


--APPOINTMENT
--APPTID, APPTDATETIME, PATIENTID, BILLINGTYPE, INSCOID, PROVID, APPTSTATUSCODE, PMTSTATUS

INSERT INTO APPOINTMENT_ilw
VALUES (101, TO_DATE('2/19/24 9:00AM', 'MM/DD/YY HH:MIAM'), 101, 'I', 323, 2, 'CM', 'PD');

INSERT INTO APPOINTMENT_ilw
VALUES (102, TO_DATE('2/19/24 9:00AM', 'MM/DD/YY HH:MIAM'), 100, 'I', 129, 5, 'CM', 'PP');

INSERT INTO APPOINTMENT_ilw
VALUES (103, TO_DATE('2/19/24 10:00AM', 'MM/DD/YY HH:MIAM'), 15, 'SP', NULL, 2, 'CM', 'PD');

INSERT INTO APPOINTMENT_ilw
VALUES (104, TO_DATE('2/19/24 10:30AM', 'MM/DD/YY HH:MIAM'), 77, 'WC', 210, 1, 'CM', 'PD');

INSERT INTO APPOINTMENT_ilw
VALUES (105, TO_DATE('2/19/24 10:30AM', 'MM/DD/YY HH:MIAM'), 119, 'I', 129, 2, 'CM', 'PP');

INSERT INTO APPOINTMENT_ilw
VALUES (106, TO_DATE('2/19/24 10:30AM', 'MM/DD/YY HH:MIAM'), 97, 'SP', NULL, 3, 'CM', 'NP');

INSERT INTO APPOINTMENT_ilw
VALUES (107, TO_DATE('2/19/24 11:30AM', 'MM/DD/YY HH:MIAM'), 28, 'I', 129, 3, 'CN', 'PP');

INSERT INTO APPOINTMENT_ilw
VALUES (108, TO_DATE('2/19/24 11:30AM', 'MM/DD/YY HH:MIAM'), 105, 'I', 323, 2, 'CN', 'NP');

INSERT INTO APPOINTMENT_ilw
VALUES (109, TO_DATE('2/19/24 2:00PM', 'MM/DD/YY HH:MIPM'), 84, 'I', 135, 5, 'CN', 'NP');

INSERT INTO APPOINTMENT_ilw
VALUES (110, TO_DATE('2/20/24 8:30AM', 'MM/DD/YY HH:MIAM'), 84, 'I', 135, 3, 'NC', 'NP');

INSERT INTO APPOINTMENT_ilw
VALUES (111, TO_DATE('2/20/24 8:30AM', 'MM/DD/YY HH:MIAM'), 23, 'WC', 323, 5, 'CN', 'NP');


--APPTDETAIL
INSERT INTO APPTDETAIL_ilw
VALUES (101, 'NP');

INSERT INTO APPTDETAIL_ilw
VALUES (101, 'GBP');

INSERT INTO APPTDETAIL_ilw
VALUES (101, 'XR');

INSERT INTO APPTDETAIL_ilw
VALUES (102, 'PSF');

INSERT INTO APPTDETAIL_ilw
VALUES (102, 'SR');

INSERT INTO APPTDETAIL_ilw
VALUES (103, 'PSF');

INSERT INTO APPTDETAIL_ilw
VALUES (103, 'SR');

INSERT INTO APPTDETAIL_ilw
VALUES (104, 'PT30');

INSERT INTO APPTDETAIL_ilw
VALUES (105, 'NP');

INSERT INTO APPTDETAIL_ilw
VALUES (105, 'BI');

INSERT INTO APPTDETAIL_ilw
VALUES (106, 'PT60');

INSERT INTO APPTDETAIL_ilw
VALUES (107, 'PT30');

INSERT INTO APPTDETAIL_ilw
VALUES (108, 'GBP');

INSERT INTO APPTDETAIL_ilw
VALUES (109, 'PSF');

INSERT INTO APPTDETAIL_ilw
VALUES (109, 'SR');

INSERT INTO APPTDETAIL_ilw
VALUES (110, 'PT60');

INSERT INTO APPTDETAIL_ilw
VALUES (111, 'NP');

INSERT INTO APPTDETAIL_ilw
VALUES (111, 'HP');

INSERT INTO APPTDETAIL_ilw
VALUES (111, 'XR');

COMMIT ;

--Part 2B

SELECT * FROM APPTDETAIL_ilw ;
SELECT * FROM APPOINTMENT_ilw ;
SELECT * FROM TREATMENT_ilw ;
SELECT * FROM BLOCKCODE_ilw ;
SELECT * FROM PATIENT_ilw ;
SELECT * FROM BILLINGTYPE_ilw ;
SELECT * FROM INSURANCECO_ilw ;
SELECT * FROM PROVIDER_ilw ;
SELECT * FROM APPTSTATUS_ilw ;
SELECT * FROM PMTSTATUS_ilw ;


--Part 3

UPDATE PATIENT_ilw
SET PatientPhone = '2145551234'
WHERE PatientID = 100;

INSERT INTO PATIENT_ilw
VALUES (120, 'Amanda', 'Green', NULL);

INSERT INTO TREATMENT_ilw
VALUES ('CI1', 'Cortizone Injection 1', 50, 'L1');

INSERT INTO TREATMENT_ilw
VALUES ('CI2', 'Cortizone Injection 2', 100, 'L1');


UPDATE APPOINTMENT_ilw
SET ApptDateTime = TO_DATE('2/21/2024 11:30AM', 'MM/DD/YYYY HH:MIAM')
WHERE ApptID = 108;

UPDATE APPOINTMENT_ilw
SET BillingType = 'WC'
WHERE ApptID = 107;

INSERT INTO APPOINTMENT_ilw
VALUES (112, TO_DATE('2/21/24 9:00AM', 'MM/DD/YY HH:MIAM'), 120, 'SP', NULL, 2, 'NC', 'NP');

INSERT INTO APPTDETAIL_ilw
VALUES (112, 'NP');

INSERT INTO APPTDETAIL_ilw
VALUES (112, 'HP');

INSERT INTO APPTDETAIL_ilw
VALUES (112, 'CI2');

UPDATE APPTDETAIL_ilw
SET TreatmentCode = 'GBP'
WHERE TreatmentCode = 'BI' and ApptID = 105;

COMMIT ;


--Part 4

SELECT * FROM APPTDETAIL_ilw 
ORDER BY ApptID, TreatmentCode ;

SELECT * FROM APPOINTMENT_ilw 
ORDER BY ApptID ;

SELECT * FROM TREATMENT_ilw 
ORDER BY TreatmentCode;

SELECT * FROM BLOCKCODE_ilw 
ORDER BY BlockCode ;

SELECT * FROM PATIENT_ilw 
ORDER BY PatientID ;

SELECT * FROM BILLINGTYPE_ilw 
ORDER BY BillingType ;

SELECT * FROM INSURANCECO_ilw 
ORDER BY InsCoID ;

SELECT * FROM PROVIDER_ilw 
ORDER BY ProviderID ;

SELECT * FROM APPTSTATUS_ilw 
ORDER BY ApptStatusCode ;

SELECT * FROM PMTSTATUS_ilw 
ORDER BY PmtStatus;

set echo off

spool off
